<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BALANZ - Mesa IFA Off Shore</title>
<script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>

<style>
  :root{
    --azul:#003366;        /* azul Balanz */
    --gris-bg:#f5f6f8;     /* fondo */
    --gris-borde:#d9dee5;  /* bordes suaves */
    --gris-text:#425466;   /* texto */
    --blanco:#ffffff;
  }

  /* Base */
  *{box-sizing:border-box}
  body{margin:0;background:var(--gris-bg);color:var(--gris-text);font:14px/1.5 "Segoe UI",system-ui,-apple-system,Roboto,Arial,sans-serif}

  /* Header con título solicitado */
  header{
    background:var(--azul);
    color:var(--blanco);
    padding:16px 24px;
    display:flex;align-items:center;justify-content:center;
    box-shadow:0 2px 8px rgba(0,0,0,.15);
  }
  .brand{
    font-weight:800;
    letter-spacing:.12em;     /* tracking parecido al logo */
    text-transform:uppercase;
    font-size:20px;
  }
  .brand .light{font-weight:600;letter-spacing:.02em;text-transform:none}

  /* Layout */
  .wrap{max-width:1120px;margin:24px auto;padding:0 16px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .card{background:var(--blanco);border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,.06);padding:16px;border:1px solid var(--gris-borde)}
  .title{color:var(--azul);font-weight:800;margin:0 0 12px;font-size:18px}

  /* Controles */
  .row{display:flex;align-items:center;gap:10px;margin:8px 0}
  .row label{min-width:110px}
  input[type=range]{width:100%;accent-color:var(--azul)}
  .small{font-size:12px;color:#6b7280}
  .reset{background:var(--azul);color:#fff;border:none;border-radius:8px;padding:6px 10px;cursor:pointer}

  /* KPIs */
  .kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-top:16px}
  .kpi{background:#f9fafb;border-radius:10px;padding:12px;text-align:center;border:1px solid var(--gris-borde)}
  .kpi .label{font-size:12px;color:#6b7280}
  .kpi .val{font-weight:800;color:var(--azul);font-size:20px}
  .mono{font-variant-numeric:tabular-nums}
</style>
</head>
<body>
  <header>
    <div class="brand">BALANZ <span class="light">– Mesa IFA Off Shore</span></div>
  </header>

  <div class="wrap">
    <!-- Controles -->
    <div class="grid">
      <!-- AUM -->
      <div class="card">
        <h2 class="title">AUM</h2>
        <div class="row">
          <label>AUM (USD)</label>
          <input id="aum" type="range" min="100000" max="5000000" step="50000" value="600000">
          <span id="aumVal" class="mono"></span>
        </div>
      </div>

      <!-- Pesos -->
      <div class="card">
        <h2 class="title">Pesos por fondo</h2>
        <div id="sliders">
          <div class="row"><label>BINCOME</label>   <input id="wBINCOME"   type="range" min="0" max="100" step="1" value="20"><span id="wBINCOMEVal"   class="mono"></span></div>
          <div class="row"><label>BLATAM</label>    <input id="wBLATAM"    type="range" min="0" max="100" step="1" value="20"><span id="wBLATAMVal"    class="mono"></span></div>
          <div class="row"><label>BBALANCED</label> <input id="wBBALANCED" type="range" min="0" max="100" step="1" value="20"><span id="wBBALANCEDVal" class="mono"></span></div>
          <div class="row"><label>BGLOBAL</label>   <input id="wBGLOBAL"   type="range" min="0" max="100" step="1" value="20"><span id="wBGLOBALVal"   class="mono"></span></div>
          <div class="row"><label>BCRYPTO</label>   <input id="wBCRYPTO"   type="range" min="0" max="100" step="1" value="20"><span id="wBCRYPTOVal"   class="mono"></span></div>

          <div class="row" style="justify-content:space-between">
            <div class="small">Suma sliders = <span id="sumRaw" class="mono">100%</span> · Normalizado = <span id="sumNorm" class="mono">100%</span></div>
            <button class="reset" id="equalBtn">Distribuir 20% c/u</button>
          </div>
        </div>
      </div>
    </div>

    <!-- KPIs -->
    <div class="kpis">
      <div class="kpi"><div class="label">AUM</div><div class="val mono" id="kAUM">-</div></div>
      <div class="kpi"><div class="label">TNA ponderada (anual)</div><div class="val mono" id="kTNA">-</div></div>
      <div class="kpi"><div class="label">Comisión mensual</div><div class="val mono" id="kMensual">-</div></div>
      <div class="kpi"><div class="label">Comisión anual</div><div class="val mono" id="kAnual">-</div></div>
    </div>

    <!-- Donut -->
    <div class="card" style="margin-top:16px">
      <h2 class="title">Composición de la cartera</h2>
      <div id="donut" style="height:360px"></div>
    </div>
  </div>

  <script>
    // Fondos + TNA anual (decimal)
    const funds = ["BINCOME","BLATAM","BBALANCED","BGLOBAL","BCRYPTO"];
    const fees  = { BINCOME:0.0060, BLATAM:0.0100, BBALANCED:0.0125, BGLOBAL:0.0125, BCRYPTO:0.0175 };

    const fmtMoney  = v => new Intl.NumberFormat('es-AR',{style:'currency',currency:'USD',maximumFractionDigits:0}).format(v);
    const fmtMoney2 = v => new Intl.NumberFormat('es-AR',{style:'currency',currency:'USD',maximumFractionDigits:2}).format(v);

    function update(){
      // AUM
      const aum = Number(document.getElementById("aum").value);
      document.getElementById("aumVal").textContent = fmtMoney(aum);

      // Leer sliders
      const raw = funds.map(f => Number(document.getElementById(`w${f}`).value));
      const sumRaw = raw.reduce((a,b)=>a+b,0);

      // Normalización (siempre 100 %)
      const norm = raw.map(v => sumRaw === 0 ? 0 : (v / sumRaw) * 100);

      // Mostrar % normalizado
      funds.forEach((f,i)=>{ document.getElementById(`w${f}Val`).textContent = norm[i].toFixed(1) + "%"; });
      document.getElementById("sumRaw").textContent  = sumRaw.toFixed(0) + "%";
      document.getElementById("sumNorm").textContent = "100%";

      // Cálculos: TNA ponderada y comisiones
      const w   = norm.map(x => x/100);
      const tna = funds.reduce((acc,f,i)=> acc + w[i]*fees[f], 0);
      const anual   = aum * tna;
      const mensual = anual / 12;

      // KPIs
      document.getElementById("kAUM").textContent     = fmtMoney(aum);
      document.getElementById("kTNA").textContent     = (tna*100).toFixed(2) + "%";
      document.getElementById("kMensual").textContent = fmtMoney2(mensual);
      document.getElementById("kAnual").textContent   = fmtMoney2(anual);

      // Donut
      Plotly.react("donut", [{
        type:"pie",
        labels:funds,
        values:norm,
        hole:0.58,
        textinfo:"label+percent",
        marker:{colors:['#003366','#2F557F','#5A78A1','#9BB1C6','#CFCFCF']},
        hovertemplate:"%{label}: %{value:.1f}%<extra></extra>"
      }], {margin:{t:16,b:16,l:8,r:8},showlegend:false});
    }

    // Eventos
    document.querySelectorAll("input[type=range]").forEach(el => el.addEventListener("input", update));
    document.getElementById("equalBtn").addEventListener("click", () => {
      funds.forEach(f => document.getElementById(`w${f}`).value = 20);
      update();
    });

    // Init
    update();
  </script>
</body>
</html>

